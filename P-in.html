<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gi·∫£ Thuy·∫øt P_in: Khung V≈© Tr·ª• H·ªçc Kh·ªüi Nguy√™n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Marked for Markdown rendering in Chat -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Exo+2:wght@300;500;700;900&family=Inter:wght@400;600&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617; /* Slate 950 */
            color: #e2e8f0;
            overflow-x: hidden;
        }

        h1, h2, h3, h4 {
            font-family: 'Exo 2', sans-serif;
        }

        /* Chart Container Styling Rules */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 100%;
            height: 350px;
            max-height: 400px;
            margin: 0 auto;
        }
        
        .plotly-container {
            width: 100%;
            height: 400px;
            position: relative;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(56, 189, 248, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .neon-text-gold {
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        .neon-border {
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.2);
        }

        /* --- AI WIDGET STYLES --- */
        .ai-widget {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 400px;
            max-width: 90vw;
            height: 550px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(34, 211, 238, 0.3);
            border-radius: 1rem;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            transform: translateY(120%);
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            z-index: 50;
            overflow: hidden;
        }

        .ai-widget.open {
            transform: translateY(0);
        }

        .ai-toggle-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: linear-gradient(135deg, #22d3ee, #0ea5e9);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(34, 211, 238, 0.4);
            z-index: 51;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .ai-toggle-btn:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 0 30px rgba(34, 211, 238, 0.6);
        }

        .ai-toggle-btn.active {
            transform: rotate(45deg);
            background: #ef4444;
            border-color: #ef4444;
        }

        .chat-header {
            padding: 1rem;
            background: rgba(15, 23, 42, 0.8);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            scroll-behavior: smooth;
        }

        .message {
            max-width: 85%;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            font-size: 0.9rem;
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
        }

        .user-msg {
            background: rgba(251, 191, 36, 0.15);
            border: 1px solid rgba(251, 191, 36, 0.3);
            color: #fef3c7;
            align-self: flex-end;
            border-bottom-right-radius: 0.25rem;
        }

        .ai-msg {
            background: rgba(34, 211, 238, 0.1);
            border: 1px solid rgba(34, 211, 238, 0.2);
            color: #ecfeff;
            align-self: flex-start;
            border-bottom-left-radius: 0.25rem;
        }

        .ai-msg strong { color: #22d3ee; font-weight: 700; }
        .ai-msg code { background: rgba(0,0,0,0.3); padding: 2px 4px; border-radius: 4px; font-family: monospace; color: #fbbf24; }

        .typing-indicator span {
            display: inline-block;
            width: 6px;
            height: 6px;
            background-color: #22d3ee;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out both;
            margin: 0 2px;
        }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Explain Button */
        .explain-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(34, 211, 238, 0.2);
            color: #22d3ee;
            font-size: 10px;
            margin-left: 8px;
            cursor: pointer;
            border: 1px solid rgba(34, 211, 238, 0.4);
            transition: all 0.2s;
        }
        .explain-btn:hover {
            background: #22d3ee;
            color: #000;
            transform: scale(1.2);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    </style>
</head>
<body class="antialiased">

    <!-- Hero Section -->
    <header class="relative w-full py-20 px-4 text-center bg-[url('https://images.unsplash.com/photo-1462331940025-496dfbfc7564?q=80&w=2000&auto=format&fit=crop')] bg-cover bg-center bg-no-repeat">
        <div class="absolute inset-0 bg-slate-950/90"></div>
        <div class="relative z-10 max-w-5xl mx-auto">
            <span class="inline-block py-1 px-3 rounded-full bg-amber-500/10 border border-amber-500/30 text-amber-400 text-xs font-bold tracking-wider mb-4">COSMOGENESIS HYPOTHESIS</span>
            <h1 class="text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-amber-200 via-amber-400 to-amber-600 mb-6 neon-text-gold">
                THE P_IN HYPOTHESIS
            </h1>
            <p class="text-xl md:text-2xl text-slate-300 font-light max-w-3xl mx-auto leading-relaxed">
                M·ªôt khung v≈© tr·ª• h·ªçc kh·ªüi nguy√™n v∆∞·ª£t qua ƒëi·ªÉm k·ª≥ d·ªã Big Bang b·∫±ng <span class="text-amber-400 font-bold">ƒêi·ªÅu Ki·ªán Bi√™n NƒÉng L∆∞·ª£ng</span>.
            </p>
            <div class="mt-8 flex justify-center gap-6 text-sm font-mono text-cyan-400">
                <div class="cursor-pointer hover:text-cyan-300 transition-colors" onclick="askAI('Gi·∫£i th√≠ch Ngh·ªãch l√Ω Russell trong b·ªëi c·∫£nh v≈© tr·ª• h·ªçc')">[Russell's Paradox]</div>
                <div>‚Ä¢</div>
                <div class="cursor-pointer hover:text-cyan-300 transition-colors" onclick="askAI('Gi·∫£i th√≠ch C·∫ßu Einstein-Rosen v√† vai tr√≤ c·ªßa n√≥ trong P_in')">[Einstein-Rosen Bridge]</div>
                <div>‚Ä¢</div>
                <div class="cursor-pointer hover:text-cyan-300 transition-colors" onclick="askAI('T·∫°i sao Big Bang vi ph·∫°m b·∫£o to√†n nƒÉng l∆∞·ª£ng?')">[Energy Conservation]</div>
            </div>
        </div>
    </header>

    <!-- Main Content Grid -->
    <main class="max-w-7xl mx-auto px-4 py-12 grid grid-cols-1 md:grid-cols-12 gap-8">

        <!-- Section 1: The Three Pillars Failure -->
        <section class="md:col-span-12 lg:col-span-5 glass-panel rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-4 flex items-center">
                <span class="w-1 h-8 bg-rose-500 mr-3 rounded-full"></span>
                T·∫°i sao Big Bang th·∫•t b·∫°i?
                <button class="explain-btn" onclick="askAI('T·∫°i sao Big Bang l·∫°i b·ªã coi l√† th·∫•t b·∫°i v·ªÅ m·∫∑t logic?')" title="H·ªèi AI">‚ú®</button>
            </h2>
            <p class="text-slate-400 mb-6 text-justify leading-relaxed">
                M√¥ h√¨nh hi·ªán t·∫°i gi·∫£ ƒë·ªãnh v≈© tr·ª• t·ª± sinh ra t·ª´ m·ªôt ƒëi·ªÉm k·ª≥ d·ªã (singularity). ƒêi·ªÅu n√†y vi ph·∫°m ba nguy√™n t·∫Øc n·ªÅn t·∫£ng c·ªßa v·∫≠t l√Ω v√† logic h·ªçc. Gi·∫£ thuy·∫øt P_in gi·∫£i quy·∫øt tri·ªát ƒë·ªÉ c√°c m√¢u thu·∫´n n√†y.
            </p>
            <div class="chart-container">
                <canvas id="pillarsChart"></canvas>
            </div>
            <p class="text-xs text-center text-slate-500 mt-2">So s√°nh m·ª©c ƒë·ªô vi ph·∫°m nguy√™n t·∫Øc (Th·∫•p h∆°n l√† t·ªët h∆°n)</p>
        </section>

        <!-- Section 2: The Logic (Concept) -->
        <section class="md:col-span-12 lg:col-span-7 glass-panel rounded-2xl p-8 flex flex-col justify-center">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Card 1: Russell -->
                <div class="bg-slate-900/50 p-6 rounded-xl border-l-4 border-amber-500">
                    <h3 class="text-amber-400 font-bold text-lg mb-2 flex items-center justify-between">
                        1. Ngh·ªãch L√Ω Russell
                        <button class="explain-btn" onclick="askAI('H√£y gi·∫£i th√≠ch Ngh·ªãch l√Ω Russell m·ªôt c√°ch ƒë∆°n gi·∫£n nh·∫•t.')">‚ú®</button>
                    </h3>
                    <p class="text-sm text-slate-300">
                        "Kh√¥ng h·ªá th·ªëng n√†o c√≥ th·ªÉ t·ª± ch·ª©a ngu·ªìn g·ªëc c·ªßa ch√≠nh n√≥."
                        <br><br>
                        <span class="text-white italic">H·ªá qu·∫£:</span> V≈© tr·ª• c·∫ßn m·ªôt t√°c nh√¢n b√™n ngo√†i (P_in).
                    </p>
                </div>
                <!-- Card 2: ER Bridge -->
                <div class="bg-slate-900/50 p-6 rounded-xl border-l-4 border-cyan-500">
                    <h3 class="text-cyan-400 font-bold text-lg mb-2 flex items-center justify-between">
                        2. H√¨nh H·ªçc Einstein-Rosen
                        <button class="explain-btn" onclick="askAI('C·∫ßu Einstein-Rosen l√† g√¨?')">‚ú®</button>
                    </h3>
                    <p class="text-sm text-slate-300">
                        "M·ªçi ƒëa t·∫°p (manifold) ph·∫£i c√≥ mi·ªÅn xu·∫•t ph√°t li√™n k·∫øt topological."
                        <br><br>
                        <span class="text-white italic">H·ªá qu·∫£:</span> Kh√¥ng c√≥ ƒëi·ªÉm k·ª≥ d·ªã 0 k√≠ch th∆∞·ªõc.
                    </p>
                </div>
            </div>
            <div class="mt-6 bg-slate-900/50 p-6 rounded-xl border-l-4 border-rose-500">
                <h3 class="text-rose-400 font-bold text-lg mb-2">3. B·∫£o To√†n NƒÉng L∆∞·ª£ng</h3>
                <p class="text-sm text-slate-300">
                    NƒÉng l∆∞·ª£ng kh√¥ng t·ª± sinh ra trong h·ªá k√≠n. Big Bang vi ph·∫°m ƒëi·ªÅu n√†y khi cho r·∫±ng nƒÉng l∆∞·ª£ng v≈© tr·ª• xu·∫•t hi·ªán t·ª´ "h∆∞ v√¥".
                </p>
            </div>
        </section>

        <!-- Section 3: The P_in Equation (Core Data) -->
        <section class="md:col-span-12 lg:col-span-4 glass-panel rounded-2xl p-8 text-center">
            <h2 class="text-2xl font-bold text-white mb-2">Ph∆∞∆°ng Tr√¨nh Kh·ªüi Nguy√™n</h2>
            <div class="text-4xl font-black text-amber-400 my-6 tracking-widest neon-text-gold cursor-pointer hover:scale-105 transition-transform" onclick="askAI('Gi·∫£i th√≠ch √Ω nghƒ©a ph∆∞∆°ng tr√¨nh P_in = P_out + P_lost')">
                P<sub class="text-lg">in</sub> = P<sub class="text-lg">out</sub> + P<sub class="text-lg">lost</sub>
            </div>
            <p class="text-slate-400 text-sm mb-6">
                V≈© tr·ª• l√† k·∫øt qu·∫£ c·ªßa vi·ªác b∆°m nƒÉng l∆∞·ª£ng t·ª´ bi√™n.
            </p>
            <div class="chart-container" style="height: 300px;">
                <canvas id="equationChart"></canvas>
            </div>
        </section>

        <!-- Section 4: 3D Manifold Simulation (Geometry) -->
        <section class="md:col-span-12 lg:col-span-8 glass-panel rounded-2xl p-1 overflow-hidden">
            <div class="p-6 pb-0 flex justify-between items-end">
                <div>
                    <h2 class="text-2xl font-bold text-white mb-2 flex items-center">
                        <span class="w-1 h-8 bg-cyan-500 mr-3 rounded-full"></span>
                        C·∫•u tr√∫c Topo: Ph·ªÖu NƒÉng L∆∞·ª£ng
                    </h2>
                    <p class="text-slate-400 text-sm max-w-xl">
                        Thay v√¨ m·ªôt ƒëi·ªÉm k·ª≥ d·ªã (Singularity) v√¥ h·∫°n, P_in ƒë·ªÅ xu·∫•t m·ªôt c·∫•u tr√∫c ph·ªÖu (Funnel) n∆°i nƒÉng l∆∞·ª£ng ƒë∆∞·ª£c b∆°m v√†o t·ª´ kh√¥ng gian chi·ªÅu cao h∆°n (Bulk Space), ph√π h·ª£p v·ªõi c·∫ßu Einstein-Rosen.
                    </p>
                </div>
                <div class="px-3 py-1 bg-cyan-900/30 border border-cyan-500/30 rounded text-cyan-400 text-xs font-mono">
                    WebGL Render
                </div>
            </div>
            <div id="manifoldPlot" class="plotly-container"></div>
        </section>

        <!-- Section 5: The Mechanism Flow (Process) -->
        <section class="md:col-span-12 glass-panel rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-8 text-center">C∆° Ch·∫ø Chuy·ªÉn Pha: T·ª´ Ti·ªÅn-V·∫≠t L√Ω ƒë·∫øn V·∫≠t Ch·∫•t</h2>
            
            <!-- Process Diagram (HTML/CSS) -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-center relative">
                <!-- Connecting Line (Desktop) -->
                <div class="hidden md:block absolute top-1/2 left-0 w-full h-1 bg-gradient-to-r from-slate-700 via-amber-500 to-cyan-500 transform -translate-y-1/2 -z-10 opacity-30"></div>

                <!-- Step 1 -->
                <div class="bg-slate-900 border border-slate-700 p-6 rounded-xl text-center relative hover:border-amber-500 transition-colors duration-300 group cursor-pointer" onclick="askAI('Tr∆∞·ªùng Ti·ªÅn-V·∫≠t L√Ω Psi-0 l√† g√¨?')">
                    <div class="text-3xl mb-2 text-slate-500 font-serif group-hover:text-amber-500 transition-colors">œà‚ÇÄ</div>
                    <h4 class="text-amber-500 font-bold mb-1">Tr∆∞·ªùng Ti·ªÅn-V·∫≠t L√Ω</h4>
                    <p class="text-xs text-slate-400">Tr·∫°ng th√°i r·ªóng, ch∆∞a c√≥ kh√¥ng-th·ªùi gian.</p>
                </div>

                <!-- Arrow -->
                <div class="hidden md:flex justify-center text-amber-500 text-2xl font-bold">‚Üí</div>

                <!-- Step 2 -->
                <div class="bg-slate-900 border border-slate-700 p-6 rounded-xl text-center relative hover:border-amber-400 transition-colors duration-300 group cursor-pointer" onclick="askAI('Qu√° tr√¨nh Injection P_in di·ªÖn ra nh∆∞ th·∫ø n√†o?')">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-amber-600 text-white text-[10px] px-2 py-0.5 rounded font-bold">INJECTION (P_in)</div>
                    <div class="text-3xl mb-2 text-amber-400 font-serif group-hover:text-white transition-colors">œà‚Çë</div>
                    <h4 class="text-white font-bold mb-1">K√≠ch Ho·∫°t NƒÉng L∆∞·ª£ng</h4>
                    <p class="text-xs text-slate-400">Bi√™n nƒÉng l∆∞·ª£ng t√°c ƒë·ªông, ph√° v·ª° ƒë·ªëi x·ª©ng.</p>
                </div>

                 <!-- Arrow -->
                 <div class="hidden md:flex justify-center text-cyan-500 text-2xl font-bold">‚Üí</div>

                <!-- Step 3 -->
                <div class="bg-slate-900 border border-slate-700 p-6 rounded-xl text-center relative hover:border-cyan-500 transition-colors duration-300 neon-border cursor-pointer" onclick="askAI('P_out v√† P_lost kh√°c nhau nh∆∞ th·∫ø n√†o?')">
                    <div class="text-3xl mb-2 text-cyan-400 font-serif">e‚Åª / m</div>
                    <h4 class="text-cyan-400 font-bold mb-1">V·∫≠t Ch·∫•t / Th·ªùi Gian</h4>
                    <p class="text-xs text-slate-400">Kh√¥ng-th·ªùi gian h√¨nh th√†nh (P_out).</p>
                </div>
            </div>
        </section>

        <!-- Section 6: Comprehensive Comparison (Radar) -->
        <section class="md:col-span-12 lg:col-span-6 glass-panel rounded-2xl p-8">
            <h2 class="text-2xl font-bold text-white mb-6 border-l-4 border-amber-500 pl-4">ƒê√°nh Gi√° T√≠nh Nh·∫•t Qu√°n</h2>
            <div class="chart-container">
                <canvas id="consistencyChart"></canvas>
            </div>
        </section>

        <!-- Section 7: Key Takeaway -->
        <section class="md:col-span-12 lg:col-span-6 glass-panel rounded-2xl p-8 flex flex-col justify-center">
            <h2 class="text-2xl font-bold text-white mb-6 border-l-4 border-cyan-500 pl-4">K·∫øt Lu·∫≠n C·ªët L√µi</h2>
            <ul class="space-y-4">
                <li class="flex items-start">
                    <span class="text-amber-500 mr-2 text-xl">‚ùñ</span>
                    <p class="text-slate-300 text-sm"><strong>Lo·∫°i b·ªè ƒêi·ªÉm K·ª≥ D·ªã:</strong> V≈© tr·ª• kh√¥ng b·∫Øt ƒë·∫ßu t·ª´ con s·ªë 0 hay s·ª± v√¥ h·∫°n phi l√Ω, m√† t·ª´ m·ªôt ngu·ªìn cung c·∫•p nƒÉng l∆∞·ª£ng x√°c ƒë·ªãnh.</p>
                </li>
                <li class="flex items-start">
                    <span class="text-amber-500 mr-2 text-xl">‚ùñ</span>
                    <p class="text-slate-300 text-sm"><strong>Th·ªèa m√£n Logic:</strong> Gi·∫£i quy·∫øt ngh·ªãch l√Ω "T·∫≠p h·ª£p ch·ª©a ch√≠nh n√≥" b·∫±ng c√°ch ƒë∆∞a ngu·ªìn g·ªëc ra ngo√†i h·ªá th·ªëng (Boundary-Driven).</p>
                </li>
                <li class="flex items-start">
                    <span class="text-amber-500 mr-2 text-xl">‚ùñ</span>
                    <p class="text-slate-300 text-sm"><strong>H·ªôi nh·∫≠p V·∫≠t l√Ω Hi·ªán ƒë·∫°i:</strong> T∆∞∆°ng th√≠ch v·ªõi L√Ω thuy·∫øt D√¢y (String Theory) v√† ƒêa v≈© tr·ª• (Multiverse) th√¥ng qua c∆° ch·∫ø m√†ng (brane) va ch·∫°m ho·∫∑c b∆°m nƒÉng l∆∞·ª£ng.</p>
                </li>
            </ul>
        </section>

    </main>

    <!-- Footer -->
    <footer class="w-full py-8 text-center text-slate-600 text-xs border-t border-slate-800 bg-slate-950">
        <p>INFOGRAPHIC ƒê∆Ø·ª¢C T·∫†O D·ª∞A TR√äN T√ÄI LI·ªÜU "THE P_IN HYPOTHESIS" ‚Ä¢ PHAN TH√ÄNH TRUNG & GPT-BASED THEORETICAL SYSTEM</p>
    </footer>

    <!-- AI Floating Widget -->
    <button id="aiToggleBtn" class="ai-toggle-btn" title="Tr·ª£ L√Ω V≈© Tr·ª•">
        ‚ú®
    </button>

    <div id="aiWidget" class="ai-widget">
        <!-- Header -->
        <div class="chat-header">
            <h3 class="text-cyan-400 font-bold flex items-center gap-2">
                <span>ü§ñ</span> Tr·ª£ L√Ω V≈© Tr·ª•
            </h3>
            <button id="debateBtn" class="text-xs bg-amber-900/50 hover:bg-amber-900 text-amber-300 px-2 py-1 rounded border border-amber-500/30 transition-colors">
                ‚öîÔ∏è Tranh Lu·∫≠n
            </button>
        </div>

        <!-- Chat Area -->
        <div id="chatMessages" class="chat-messages">
            <div class="message ai-msg">
                Xin ch√†o, nh√† du h√†nh. T√¥i l√† <strong>Cosmic Oracle</strong>. T√¥i ·ªü ƒë√¢y ƒë·ªÉ gi·∫£i m√£ nh·ªØng b√≠ ·∫©n v·ªÅ Gi·∫£ thuy·∫øt P_in.
                <br><br>
                B·∫°n c√≥ th·ªÉ h·ªèi t√¥i v·ªÅ:
                <ul class="mt-2 text-xs">
                    <li>S·ª± kh√°c bi·ªát gi·ªØa Big Bang v√† P_in?</li>
                    <li>NƒÉng l∆∞·ª£ng P_in ƒë·∫øn t·ª´ ƒë√¢u?</li>
                    <li>T·∫°i sao ƒëi·ªÉm k·ª≥ d·ªã l·∫°i v√¥ l√Ω?</li>
                </ul>
                <div class="mt-2 text-[10px] text-cyan-600 italic">M·∫πo: Nh·∫•n v√†o c√°c n√∫t ‚ú® tr√™n m√†n h√¨nh ƒë·ªÉ h·ªèi nhanh.</div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-4 border-t border-cyan-500/20 bg-slate-900/80">
            <div class="flex gap-2">
                <input type="text" id="userInput" 
                    class="flex-1 bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-cyan-500 transition-colors placeholder-slate-500"
                    placeholder="H·ªèi v·ªÅ ngu·ªìn g·ªëc v≈© tr·ª•...">
                <button id="sendBtn" class="bg-cyan-600 hover:bg-cyan-700 text-white p-2 rounded-lg transition-colors disabled:opacity-50">
                    ‚û§
                </button>
            </div>
            <div class="text-[10px] text-slate-500 mt-2 text-center">
                Powered by Google Gemini 2.5 Flash
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // --- UTILITIES ---
        function wrapLabel(str, maxLen = 16) {
            if (str.length <= maxLen) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if (currentLine.length + 1 + words[i].length <= maxLen) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        const commonChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: { color: '#cbd5e1', font: { family: 'Inter' } }
                },
                tooltip: {
                    backgroundColor: 'rgba(15, 23, 42, 0.9)',
                    titleColor: '#fbbf24',
                    bodyColor: '#e2e8f0',
                    borderColor: 'rgba(251, 191, 36, 0.3)',
                    borderWidth: 1,
                    padding: 10,
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) return label.join(' ');
                            return label;
                        }
                    }
                }
            }
        };

        // --- CHARTS (Bar, Doughnut, Plotly, Radar) ---
        // (Re-implemented for completeness)
        {
            const ctxPillars = document.getElementById('pillarsChart').getContext('2d');
            const pillarLabels = ["Vi ph·∫°m Logic (Russell)", "Vi ph·∫°m B·∫£o to√†n NƒÉng l∆∞·ª£ng", "B·∫•t ƒë·ªãnh h√¨nh h·ªçc (K·ª≥ d·ªã)"];
            new Chart(ctxPillars, {
                type: 'bar',
                data: {
                    labels: pillarLabels.map(l => wrapLabel(l)),
                    datasets: [
                        { label: 'M√¥ h√¨nh Big Bang', data: [90, 95, 100], backgroundColor: 'rgba(244, 63, 94, 0.5)', borderColor: '#f43f5e', borderWidth: 1 },
                        { label: 'Gi·∫£ thuy·∫øt P_in', data: [10, 5, 15], backgroundColor: 'rgba(34, 211, 238, 0.5)', borderColor: '#22d3ee', borderWidth: 1 }
                    ]
                },
                options: { ...commonChartOptions, indexAxis: 'y', scales: { x: { beginAtZero: true, max: 100, grid: { color: '#334155' } }, y: { grid: { display: false } } } }
            });
        }
        {
            const ctxEquation = document.getElementById('equationChart').getContext('2d');
            new Chart(ctxEquation, {
                type: 'doughnut',
                data: {
                    labels: ['P_out (V·∫≠t ch·∫•t)', 'P_lost (Entropy)'],
                    datasets: [{ data: [70, 30], backgroundColor: ['#22d3ee', '#f43f5e'], borderColor: '#0f172a', borderWidth: 2 }]
                },
                options: { ...commonChartOptions, cutout: '70%', plugins: { ...commonChartOptions.plugins, legend: { position: 'bottom', labels: { color: '#cbd5e1' } } } }
            });
        }
        {
            const size = 40;
            const x = [], y = [], z = [];
            for (let i = -size; i <= size; i += 4) {
                for (let j = -size; j <= size; j += 4) {
                    const r = Math.sqrt(i*i + j*j);
                    let val = -20 / (r + 2); 
                    x.push(i); y.push(j); z.push(val);
                }
            }
            Plotly.newPlot('manifoldPlot', [{
                x: x, y: y, z: z, type: 'mesh3d', intensity: z,
                colorscale: [[0, '#020617'], [0.5, '#22d3ee'], [1, '#fbbf24']],
                opacity: 0.9, flatshading: true
            }], {
                paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0)',
                margin: { l: 0, r: 0, b: 0, t: 0 },
                scene: {
                    xaxis: { visible: false }, yaxis: { visible: false },
                    zaxis: { title: 'Energy Depth', showgrid: true, gridcolor: '#334155' },
                    camera: { eye: { x: 1.5, y: 1.5, z: 1.2 } }
                }, showlegend: false
            }, {displayModeBar: false});
        }
        {
            const ctxConsistency = document.getElementById('consistencyChart').getContext('2d');
            const consistencyLabels = ["Logic To√°n h·ªçc", "B·∫£o to√†n NƒÉng l∆∞·ª£ng", "T√≠nh h·ª£p l·ªá H√¨nh h·ªçc", "Kh·∫£ nƒÉng m·ªü r·ªông", "Gi·∫£i th√≠ch Kh·ªüi nguy√™n"];
            new Chart(ctxConsistency, {
                type: 'radar',
                data: {
                    labels: consistencyLabels.map(l => wrapLabel(l)),
                    datasets: [{
                        label: 'Gi·∫£ thuy·∫øt P_in', data: [95, 100, 90, 85, 95], fill: true, backgroundColor: 'rgba(251, 191, 36, 0.2)', borderColor: '#fbbf24',
                    }, {
                        label: 'M√¥ h√¨nh Big Bang', data: [40, 30, 50, 60, 45], fill: true, backgroundColor: 'rgba(148, 163, 184, 0.2)', borderColor: '#94a3b8',
                    }]
                },
                options: { ...commonChartOptions, scales: { r: { angleLines: { color: '#334155' }, grid: { color: '#334155' }, pointLabels: { color: '#e2e8f0', font: { size: 10 } }, ticks: { display: false } } } }
            });
        }

        // --- GEMINI AI INTEGRATION ---
        const aiToggleBtn = document.getElementById('aiToggleBtn');
        const aiWidget = document.getElementById('aiWidget');
        const chatMessages = document.getElementById('chatMessages');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const debateBtn = document.getElementById('debateBtn');
        let isChatOpen = false;

        // Functions
        function toggleChat() {
            isChatOpen = !isChatOpen;
            if (isChatOpen) {
                aiWidget.classList.add('open');
                aiToggleBtn.classList.add('active');
                aiToggleBtn.innerHTML = '‚úï';
                setTimeout(() => userInput.focus(), 300);
            } else {
                aiWidget.classList.remove('open');
                aiToggleBtn.classList.remove('active');
                aiToggleBtn.innerHTML = '‚ú®';
            }
        }

        aiToggleBtn.addEventListener('click', toggleChat);

        // Global function for "Explain" buttons
        window.askAI = function(question) {
            if (!isChatOpen) toggleChat();
            userInput.value = question;
            handleSend();
        }

        function addMessage(text, isUser = false) {
            const div = document.createElement('div');
            div.className = `message ${isUser ? 'user-msg' : 'ai-msg'}`;
            div.innerHTML = isUser ? text : marked.parse(text);
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showLoading() {
            const div = document.createElement('div');
            div.className = 'message ai-msg typing-indicator';
            div.id = 'loadingIndicator';
            div.innerHTML = '<span></span><span></span><span></span>';
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeLoading() {
            const loader = document.getElementById('loadingIndicator');
            if (loader) loader.remove();
        }

        async function callGemini(promptText) {
            const apiKey = ""; // Runtime provided
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const systemPrompt = `
                B·∫°n l√† 'Cosmic Oracle', m·ªôt AI chuy√™n gia v·ªÅ 'Gi·∫£ thuy·∫øt P_in' (The P_in Hypothesis) c·ªßa t√°c gi·∫£ Phan Th√†nh Trung.
                
                TH√îNG TIN V·ªÄ GI·∫¢ THUY·∫æT P_IN:
                - M·ª•c ti√™u: Kh·∫Øc ph·ª•c ƒëi·ªÉm y·∫øu c·ªßa Big Bang (ƒëi·ªÉm k·ª≥ d·ªã, vi ph·∫°m logic t·ª± ch·ª©a, vi ph·∫°m b·∫£o to√†n nƒÉng l∆∞·ª£ng).
                - Gi·∫£i ph√°p: V≈© tr·ª• kh√¥ng t·ª± sinh (self-originating) m√† ƒë∆∞·ª£c k√≠ch ho·∫°t b·ªüi nƒÉng l∆∞·ª£ng ƒë·∫ßu v√†o (P_in) t·ª´ b√™n ngo√†i (Bulk Space/Higher Dimension).
                - C√¥ng th·ª©c: P_in = P_out (v≈© tr·ª• v·∫≠t ch·∫•t) + P_lost (nhi·ªát nƒÉng/entropy).
                - H√¨nh h·ªçc: S·ª≠ d·ª•ng C·∫ßu Einstein-Rosen (Einstein-Rosen Bridge) thay v√¨ ƒëi·ªÉm k·ª≥ d·ªã 0 k√≠ch th∆∞·ªõc.
                - Logic: Gi·∫£i quy·∫øt Ngh·ªãch l√Ω Russell (t·∫≠p h·ª£p kh√¥ng th·ªÉ ch·ª©a ch√≠nh n√≥) b·∫±ng c√°ch ƒë·∫∑t ngu·ªìn g·ªëc ra ngo√†i h·ªá th·ªëng.

                PHONG C√ÅCH TR·∫¢ L·ªúI:
                - Ng√¥n ng·ªØ: Ti·∫øng Vi·ªát.
                - Gi·ªçng ƒëi·ªáu: Th√¥ng th√°i, khoa h·ªçc nh∆∞ng d·ªÖ hi·ªÉu, h∆°i h∆∞·ªõng t∆∞∆°ng lai (futuristic).
                - ƒê·ªãnh d·∫°ng: S·ª≠ d·ª•ng Markdown (in ƒë·∫≠m, danh s√°ch) ƒë·ªÉ tr√¨nh b√†y r√µ r√†ng.
            `;

            const payload = {
                contents: [{ parts: [{ text: promptText }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };

            try {
                // Simple retry mechanism
                let attempts = 0;
                while (attempts < 3) {
                    try {
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (!response.ok) throw new Error('Network response was not ok');
                        const data = await response.json();
                        return data.candidates?.[0]?.content?.parts?.[0]?.text || "T√≠n hi·ªáu v≈© tr·ª• b·ªã nhi·ªÖu. Vui l√≤ng th·ª≠ l·∫°i.";
                    } catch (e) {
                        attempts++;
                        if (attempts === 3) throw e;
                        await new Promise(r => setTimeout(r, 1000));
                    }
                }
            } catch (error) {
                console.error("Gemini Error:", error);
                return "Xin l·ªói, k·∫øt n·ªëi v·ªõi Si√™u Kh√¥ng Gian (Hyperspace) ƒëang g·∫∑p s·ª± c·ªë.";
            }
        }

        async function handleSend() {
            const text = userInput.value.trim();
            if (!text) return;

            addMessage(text, true);
            userInput.value = '';
            showLoading();

            const response = await callGemini(text);
            removeLoading();
            addMessage(response);
        }

        async function handleDebate() {
            if (!isChatOpen) toggleChat();
            addMessage("K√≠ch ho·∫°t ch·∫ø ƒë·ªô tranh lu·∫≠n gi·∫£ l·∫≠p: **Ti·∫øn sƒ© Big Bang** vs **Ti·∫øn sƒ© P_in**...", true);
            showLoading();
            
            const prompt = "H√£y t·∫°o m·ªôt cu·ªôc tranh lu·∫≠n ng·∫Øn, k·ªãch t√≠nh gi·ªØa hai nh√† khoa h·ªçc: M·ªôt ng∆∞·ªùi b·∫£o v·ªá Big Bang (d·ª±a tr√™n s·ª± gi√£n n·ªü, b·ª©c x·∫° n·ªÅn) v√† m·ªôt ng∆∞·ªùi b·∫£o v·ªá P_in (d·ª±a tr√™n logic ngu·ªìn g·ªëc v√† nƒÉng l∆∞·ª£ng). K·∫øt th√∫c b·∫±ng m·ªôt c√¢u h·ªèi m·ªü cho ng∆∞·ªùi ƒë·ªçc.";
            
            const response = await callGemini(prompt);
            removeLoading();
            addMessage(response);
        }

        sendBtn.addEventListener('click', handleSend);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleSend();
        });
        debateBtn.addEventListener('click', handleDebate);

    </script>
</body>
</html>
